<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Leveraging The Robot Pattern For Espresso Tests | Android Essence</title>
<meta property="og:title" content="Leveraging The Robot Pattern For Espresso Tests | Android Essence" />
<meta name="twitter:title" content="Leveraging The Robot Pattern For Espresso Tests | Android Essence" />
<meta itemprop="name" content="Leveraging The Robot Pattern For Espresso Tests | Android Essence" />
<meta name="application-name" content="Leveraging The Robot Pattern For Espresso Tests | Android Essence" />
<meta property="og:site_name" content="" />

<meta name="description" content="Demonstrates the benefits of the Robot pattern for automated testing in Android.">
<meta itemprop="description" content="Demonstrates the benefits of the Robot pattern for automated testing in Android." />
<meta property="og:description" content="Demonstrates the benefits of the Robot pattern for automated testing in Android." />
<meta name="twitter:description" content="Demonstrates the benefits of the Robot pattern for automated testing in Android." />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en-us" href="http://localhost:1313/posts/2017-07-04-leveraging-the-robot-pattern-for-espresso-tests/" title="" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2017-07-04T00:00:00Z />
    <meta property="article:published_time" content=2017-07-04T00:00:00Z />
    <meta property="og:url" content="http://localhost:1313/posts/2017-07-04-leveraging-the-robot-pattern-for-espresso-tests/" />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Leveraging The Robot Pattern For Espresso Tests",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2017-07-04",
        "description": "Demonstrates the benefits of the Robot pattern for automated testing in Android.",
        "wordCount":  1141 ,
        "mainEntityOfPage": "True",
        "dateModified": "2017-07-04",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Android Essence"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.148.2">

    
    <meta property="og:url" content="http://localhost:1313/posts/2017-07-04-leveraging-the-robot-pattern-for-espresso-tests/">
  <meta property="og:site_name" content="Android Essence">
  <meta property="og:title" content="Leveraging The Robot Pattern For Espresso Tests">
  <meta property="og:description" content="Demonstrates the benefits of the Robot pattern for automated testing in Android.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2017-07-04T00:00:00+00:00">
    <meta property="article:modified_time" content="2017-07-04T00:00:00+00:00">
    <meta property="article:tag" content="Espresso">
    <meta property="article:tag" content="Testing">
    <meta property="article:tag" content="Robot Pattern">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Leveraging The Robot Pattern For Espresso Tests">
  <meta name="twitter:description" content="Demonstrates the benefits of the Robot pattern for automated testing in Android.">


    

    <link rel="canonical" href="http://localhost:1313/posts/2017-07-04-leveraging-the-robot-pattern-for-espresso-tests/">
    <link href="/style.min.e390ba7da26222f4dc42a349955d76dbbe44e5ce2535a43de5a70633a0a9ec3c.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Leveraging The Robot Pattern For Espresso Tests</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2017-07-04T00:00:00&#43;00:00" itemprop="datePublished"> Jul 4, 2017 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p>Espresso is a <a href="https://developer.android.com/training/testing/ui-testing/espresso-testing.html">testing framework for Android</a> that allows developers to write automated tests for their applications. The benefit of automated testing is that you can write a test plan, and simply hit run and have all of the important features in your app tested effortlessly, and arguably more consistent and thorough than manual testing. There is no doubt that it is a lot faster.</p>
<p>However, one of the lesser known development patterns for automated testing is the robot pattern, which makes writing tests much easier while providing a painless way to update tests whenever your app changes. Let&rsquo;s take a deeper dive into what makes the robot pattern so powerful, and how to implement it in your next test suite.</p>
<p>This tutorial is going to assume a basic knowledge of Android development. Exposure to Espresso already will help, but we&rsquo;ll do a quick run down of that first.</p>
<h1 id="sample">Sample</h1>
<p>First, let&rsquo;s take a look at an example of what we&rsquo;re building. This is a simple application that takes you to a new activity to enter a person&rsquo;s information and then displays that person&rsquo;s name in the original activity:</p>
<p><img src="/espresso/sample.gif" alt="Espresso"></p>
<h1 id="espresso-cheat-sheet">Espresso Cheat Sheet</h1>
<p>Below is a quick <a href="https://google.github.io/android-testing-support-library/docs/espresso/cheatsheet/">cheat sheet</a> for using Espresso. We&rsquo;ll be using each of the categories you see below:</p>
<p><img src="/espresso-cheatsheet.png" alt="Espresso Cheat Sheet"></p>
<p>If you&rsquo;re new to Espresso, here are the take aways from that cheat sheet:</p>
<ul>
<li>ViewMatcher: This is something that describes a View that you want to interact with - whether that&rsquo;s the id, the text, the parent, or various other matchers in the above sheet.</li>
<li>ViewAction: This is an action you can perform on a View such as clicking it, typing text, and others.</li>
<li>ViewAssertion: This is used to assert something about the View like its position or whether it matches certain conditions.</li>
<li>onView(ViewMatcher): This method returns a ViewInteraction for a View that we can perform actions on or make assertions.</li>
<li>check(ViewAssertion): This method verifies that the ViewInteraction meets the given criteria.</li>
<li>perform(ViewAction): This method completes the supplied actions on the ViewInteraction.</li>
</ul>
<h1 id="test-adding-a-person">Test Adding A Person</h1>
<p>Before we get into the robot pattern, it&rsquo;s important to understand the problem it solves. In the above application, we may want to automate a test that goes to the add person activity, enters their information, clicks submit, and verifies that the person was added to the list. We can do that like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl">    <span class="nd">@Test</span>
</span></span><span class="line"><span class="cl">    <span class="k">fun</span> <span class="nf">addPersonSuccess</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Click the FAB
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">fab</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">click</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Enter all their information and click submit
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">first_name</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">clearText</span><span class="p">(),</span> <span class="n">typeText</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">firstName</span><span class="p">),</span> <span class="n">closeSoftKeyboard</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">last_name</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">clearText</span><span class="p">(),</span> <span class="n">typeText</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">lastName</span><span class="p">),</span> <span class="n">closeSoftKeyboard</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">age</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">clearText</span><span class="p">(),</span> <span class="n">typeText</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">age</span><span class="p">.</span><span class="n">toString</span><span class="p">()),</span> <span class="n">closeSoftKeyboard</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">email_address</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">clearText</span><span class="p">(),</span> <span class="n">typeText</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">emailAddress</span><span class="p">),</span> <span class="n">closeSoftKeyboard</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">submit</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">click</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Make sure we came back, check for item to be displayed
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">fab</span><span class="p">)).</span><span class="n">check</span><span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="n">isDisplayed</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withText</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">fullName</span><span class="p">)).</span><span class="n">check</span><span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="n">isDisplayed</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>Here is what our test is doing:</p>
<ol>
<li>Click the view with an id of &ldquo;fab&rdquo;</li>
<li>Find a view with the id &ldquo;first_name&rdquo;, clear the text, type in the first name, and close the keyboard. Repeat for each input.</li>
<li>Find a view with the id &ldquo;submit&rdquo; and click it.</li>
<li>Verify that the floating action button is displayed (this means we returned to the first activity).</li>
<li>Verify that a view with our input person&rsquo;s name is displayed (this is the first row in the RecyclerView).</li>
</ol>
<p>Now we can take this code, copy it, and modify it to test all error scenarios such as an empty input and verify that the error is displayed. One problem this poses is that you have many tests that are difficult to read (you start to see onView&hellip; all the time and may not easily spot differences), and another is that as you write more tests, you&rsquo;ll have more work to do if your view ever changes.</p>
<p>This downfall is demonstrated in a <a href="https://www.youtube.com/watch?v=fhx_Ji5s3p4">presentation by Sam Edwards</a>, where you can see that if your view changes, you need to go in and update every single test:</p>
<p><img src="/espresso-no-robot.png" alt="Espresso"></p>
<h1 id="robot-pattern">Robot Pattern</h1>
<p>Now, imagine you had a robot you could use to perform each action for you. If your view ever changes, you wouldn&rsquo;t have to update each individual test anymore - you&rsquo;d just need to update your robot. Our above diagram now looks something like this:</p>
<p><img src="/espresso-robot.png" alt="Espresso"></p>
<p>Before we show the robot classes code, let&rsquo;s take a look at the implementation:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl">    <span class="nd">@Test</span>
</span></span><span class="line"><span class="cl">    <span class="k">fun</span> <span class="nf">addPersonSuccess</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">fab</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">click</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">AddPersonRobot</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">firstName</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">firstName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">lastName</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">age</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">age</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">emailAddress</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">emailAddress</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">submit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Make sure we came back, check for item to be displayed
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">fab</span><span class="p">)).</span><span class="n">check</span><span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="n">isDisplayed</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withText</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">fullName</span><span class="p">)).</span><span class="n">check</span><span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="n">isDisplayed</span><span class="p">()))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>As far as our test is concerned, we just gained two big benefits by using a robot:</p>
<ol>
<li>Increased readability - no more parsing the <code>onView(...)</code> code in your head, it&rsquo;s clear based on the method names what is happening.</li>
<li>Abstracted the logic out of the test and only focus on the order. Our test no longer cares how first name is entered, it only cares that it&rsquo;s entered first, for example.</li>
</ol>
<p>With this, we can write a robot once, and use it anywhere and it makes writing the actual tests more fun. Without it, I might not want to take the time to write four negative tests (one test with bad input for each of the four fields). However, with a Robot, writing those tests will take a lot less time. In fact, it&rsquo;s a very similar amount of code, which we discussed is already much less than the original:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl">    <span class="nd">@Test</span>
</span></span><span class="line"><span class="cl">    <span class="k">fun</span> <span class="nf">checkFirstNameError</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">onView</span><span class="p">(</span><span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">fab</span><span class="p">)).</span><span class="n">perform</span><span class="p">(</span><span class="n">click</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">AddPersonRobot</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">lastName</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">lastName</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">age</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">age</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">emailAddress</span><span class="p">(</span><span class="n">testPerson</span><span class="p">.</span><span class="n">emailAddress</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">submit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="p">.</span><span class="n">matchFirstNameError</span><span class="p">(</span><span class="n">rule</span><span class="p">.</span><span class="n">activity</span><span class="p">.</span><span class="n">getString</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">string</span><span class="p">.</span><span class="n">err_first_name_blank</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>As you can see above, our robot should use the <a href="http://www.javaworld.com/article/2074938/core-java/too-many-parameters-in-java-methods-part-3-builder-pattern.html">builder pattern</a> which will allow us to chain calls together easily. Here is our <code>AddPersonRobot.kt</code> class:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">AddPersonRobot</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">fun</span> <span class="nf">firstName</span><span class="p">(</span><span class="n">firstName</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">AddPersonRobot</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">onView</span><span class="p">(</span><span class="n">FIRST_NAME_MATCHER</span><span class="p">).</span><span class="n">perform</span><span class="p">(</span><span class="n">clearText</span><span class="p">(),</span> <span class="n">typeText</span><span class="p">(</span><span class="n">firstName</span><span class="p">),</span> <span class="nc">ViewActions</span><span class="p">.</span><span class="n">closeSoftKeyboard</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">fun</span> <span class="nf">lastName</span><span class="p">(</span><span class="n">lastName</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">AddPersonRobot</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">onView</span><span class="p">(</span><span class="n">LAST_NAME_MATCHER</span><span class="p">).</span><span class="n">perform</span><span class="p">(</span><span class="n">clearText</span><span class="p">(),</span> <span class="n">typeText</span><span class="p">(</span><span class="n">lastName</span><span class="p">),</span> <span class="nc">ViewActions</span><span class="p">.</span><span class="n">closeSoftKeyboard</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">fun</span> <span class="nf">submit</span><span class="p">():</span> <span class="n">AddPersonRobot</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">onView</span><span class="p">(</span><span class="n">SUBMIT_MATCHER</span><span class="p">).</span><span class="n">perform</span><span class="p">(</span><span class="n">click</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">fun</span> <span class="nf">matchFirstNameError</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">AddPersonRobot</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">onView</span><span class="p">(</span><span class="n">FIRST_NAME_MATCHER</span><span class="p">).</span><span class="n">check</span><span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="n">hasErrorText</span><span class="p">(</span><span class="n">error</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">fun</span> <span class="nf">matchLastNameError</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">String</span><span class="p">):</span> <span class="n">AddPersonRobot</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">onView</span><span class="p">(</span><span class="n">LAST_NAME_MATCHER</span><span class="p">).</span><span class="n">check</span><span class="p">(</span><span class="n">matches</span><span class="p">(</span><span class="n">hasErrorText</span><span class="p">(</span><span class="n">error</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="k">companion</span> <span class="k">object</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">val</span> <span class="py">FIRST</span><span class="n">_NAME_MATCHER</span><span class="p">:</span> <span class="n">Matcher</span><span class="p">&lt;</span><span class="n">View</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">first_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">val</span> <span class="py">LAST</span><span class="n">_NAME_MATCHER</span><span class="p">:</span> <span class="n">Matcher</span><span class="p">&lt;</span><span class="n">View</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">withId</span><span class="p">(</span><span class="nc">R</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">last_name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></div><p>I&rsquo;ve left out some of the code for simplicity, but this demonstrates what I suggest doing for your robot class:</p>
<ol>
<li>Create static matchers for your views, so that if you ever change something about the view itself (such as its id) you only need to touch one spot.</li>
<li>Create one method for each input, and one to check each error. You might have the urge to abstract this, but I like being able to keep each input separate. I also like the readability this gives me inside the test class itself.</li>
</ol>
<p>That&rsquo;s all you need to implement the robot pattern for your tests. As linked above, Sam Edwards presentation from Droidcon 2016 goes into even deeper detail on how you can leverage this robot pattern for taking screenshots at each step of your tests. I hope you found this useful and this shows you that automated testing does not have to be as daunting as it sounds!</p>
<p>The full code for a sample application can be found on <a href="https://github.com/androidessence/EspressoSample">GitHub</a>.</p>
            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://twitch.tv/adammc" target="_blank" rel="noopener noreferrer me"
    title="Twitch">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"></path>
</svg>
</a>
<a href="https://bsky.app/profile/adammc.bsky.social" target="_blank" rel="noopener noreferrer me"
    title="Bluesky">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
    d="M11.999,10.236c0.321,-0.524 0.916,-1.507 1.405,-2.376c0.755,-1.344 1.692,-2.852 2.869,-4.028c1.283,-1.281 2.845,-2.171 4.739,-2.171c1.144,-0 1.864,0.585 2.299,1.497c0.486,1.017 0.545,2.551 0.51,3.883c-0.051,1.945 -0.232,3.337 -0.505,4.275c-0.229,0.786 -0.543,1.303 -0.878,1.615c-0.892,0.833 -1.8,1.263 -2.634,1.484c0.029,0.018 0.056,0.036 0.084,0.055c0.528,0.367 0.823,0.79 1.081,1.107c0.648,0.794 0.644,1.795 0.23,2.784c-0.481,1.151 -1.533,2.279 -2.12,2.773c-1.389,1.171 -2.506,1.362 -3.383,1.133c-0.88,-0.23 -1.59,-0.932 -2.156,-1.826c-0.45,-0.71 -0.817,-1.537 -1.176,-2.186c-0.115,-0.208 -0.302,-0.455 -0.406,-0.587c-0.02,0.019 -0.04,0.04 -0.056,0.058c-0.121,0.145 -0.234,0.328 -0.349,0.531c-0.363,0.644 -0.721,1.463 -1.157,2.166c-0.555,0.895 -1.252,1.597 -2.12,1.825c-0.863,0.227 -1.97,0.037 -3.363,-1.136c-0.586,-0.494 -1.638,-1.622 -2.119,-2.773c-0.414,-0.989 -0.418,-1.99 0.229,-2.784c0.258,-0.317 0.554,-0.74 1.082,-1.106c0.027,-0.019 0.055,-0.038 0.084,-0.056c-0.834,-0.221 -1.742,-0.651 -2.634,-1.484c-0.335,-0.312 -0.649,-0.829 -0.878,-1.615c-0.273,-0.938 -0.454,-2.33 -0.505,-4.275c-0.036,-1.332 0.024,-2.866 0.509,-3.883c0.435,-0.912 1.156,-1.497 2.3,-1.497c2.32,0 4.109,1.203 5.494,2.808c1.272,1.474 2.195,3.283 2.9,4.643c0.231,0.447 0.436,0.84 0.624,1.146Zm-0.01,5.653l0.296,0.031l0.271,0.086c0.208,0.088 0.413,0.229 0.607,0.428c0.455,0.467 0.882,1.369 1.36,2.284c0.249,0.477 0.518,0.958 0.841,1.339c0.231,0.274 0.483,0.502 0.805,0.569c0.488,0.103 1.052,-0.157 1.811,-0.797c0.452,-0.38 1.274,-1.239 1.645,-2.126c0.155,-0.371 0.265,-0.75 0.022,-1.048c-0.179,-0.22 -0.366,-0.529 -0.732,-0.783c-0.536,-0.372 -1.356,-0.51 -1.905,-0.654c-0.405,-0.106 -0.715,-0.234 -0.88,-0.355l-0.284,-0.303l-0.135,-0.367l-0.008,-0.211l0.035,-0.196l0.078,-0.195l0.142,-0.209l0.198,-0.181l0.296,-0.154c0.151,-0.055 0.348,-0.092 0.587,-0.104c0.815,-0.042 2.571,0.294 4.235,-1.259c0.171,-0.159 0.288,-0.445 0.404,-0.845c0.246,-0.843 0.391,-2.096 0.438,-3.843c0.024,-0.91 0.026,-1.938 -0.208,-2.738c-0.142,-0.486 -0.367,-0.891 -0.896,-0.891c-1.675,0 -2.974,0.983 -4.031,2.21c-1.179,1.369 -2.058,3.057 -2.752,4.321c-0.483,0.88 -0.902,1.573 -1.25,1.916c-0.088,0.086 -0.174,0.157 -0.257,0.214l-0.221,0.125l-0.228,0.078l-0.267,0.031l-0.274,-0.034l-0.231,-0.083l-0.219,-0.132c-0.081,-0.058 -0.164,-0.131 -0.248,-0.22c-0.327,-0.343 -0.718,-1.037 -1.174,-1.917c-0.654,-1.262 -1.497,-2.948 -2.676,-4.314c-1.067,-1.236 -2.417,-2.217 -4.203,-2.217c-0.53,0 -0.754,0.405 -0.896,0.891c-0.234,0.8 -0.232,1.828 -0.208,2.738c0.046,1.747 0.192,3 0.438,3.843c0.116,0.4 0.233,0.686 0.403,0.845c1.665,1.553 3.421,1.217 4.235,1.259c0.24,0.012 0.437,0.049 0.588,0.104l0.295,0.154l0.199,0.181l0.142,0.209l0.078,0.195l0.035,0.196l-0.009,0.211l-0.135,0.368l-0.283,0.303c-0.165,0.12 -0.476,0.248 -0.88,0.355c-0.549,0.144 -1.369,0.281 -1.905,0.653c-0.366,0.254 -0.554,0.564 -0.732,0.783c-0.243,0.298 -0.133,0.677 0.022,1.048c0.371,0.887 1.193,1.746 1.645,2.127c0.757,0.637 1.311,0.9 1.789,0.8c0.311,-0.066 0.55,-0.29 0.772,-0.557c0.315,-0.381 0.577,-0.86 0.822,-1.337c0.394,-0.763 0.752,-1.521 1.138,-2.01c0.431,-0.544 0.929,-0.815 1.455,-0.815Z" style="fill-rule:nonzero;"/>
</svg>
</a>
<a href="https://www.youtube.com/@AdamMc331" target="_blank" rel="noopener noreferrer me"
    title="Youtube">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z">
    </path>
    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
</svg>
</a>
<a href="https://github.com/AdamMc331" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2025 .
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer>







    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
