<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Storing Network Responses With Apollo HTTP Cache | Android Essence</title>
<meta property="og:title" content="Storing Network Responses With Apollo HTTP Cache | Android Essence" />
<meta name="twitter:title" content="Storing Network Responses With Apollo HTTP Cache | Android Essence" />
<meta itemprop="name" content="Storing Network Responses With Apollo HTTP Cache | Android Essence" />
<meta name="application-name" content="Storing Network Responses With Apollo HTTP Cache | Android Essence" />
<meta property="og:site_name" content="Android Essence" />

<meta name="description" content="Simplified Android Development">
<meta itemprop="description" content="Simplified Android Development" />
<meta property="og:description" content="Simplified Android Development" />
<meta name="twitter:description" content="Simplified Android Development" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en-us" href="http://localhost:1313/posts/storing-network-responses-with-apollo-http-cache/" title="" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2021-02-01T00:00:00Z />
    <meta property="article:published_time" content=2021-02-01T00:00:00Z />
    <meta property="og:url" content="http://localhost:1313/posts/storing-network-responses-with-apollo-http-cache/" />

    
    <meta property="og:article:author" content="Adam McNeilly" />
    <meta property="article:author" content="Adam McNeilly" />
    <meta name="author" content="Adam McNeilly" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Storing Network Responses With Apollo HTTP Cache",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2021-02-01",
        "description": "",
        "wordCount":  1094 ,
        "mainEntityOfPage": "True",
        "dateModified": "2021-02-01",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Android Essence"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.148.2">

    
    <meta property="og:url" content="http://localhost:1313/posts/storing-network-responses-with-apollo-http-cache/">
  <meta property="og:site_name" content="Android Essence">
  <meta property="og:title" content="Storing Network Responses With Apollo HTTP Cache">
  <meta property="og:description" content="Caching is the practice of storing data that we requested previously so we can serve it faster in the future. This creates a better user experience by decreasing loading times. It also has long term benefits like reducing the number of network requests, to save on phone resources or potentially provide offline support. Today, weâ€™re going to discuss how to use the HTTP cache for the Apollo Android SDK.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-02-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-02-01T00:00:00+00:00">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Storing Network Responses With Apollo HTTP Cache">
  <meta name="twitter:description" content="Caching is the practice of storing data that we requested previously so we can serve it faster in the future. This creates a better user experience by decreasing loading times. It also has long term benefits like reducing the number of network requests, to save on phone resources or potentially provide offline support. Today, weâ€™re going to discuss how to use the HTTP cache for the Apollo Android SDK.">


    

    <link rel="canonical" href="http://localhost:1313/posts/storing-network-responses-with-apollo-http-cache/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Storing Network Responses With Apollo HTTP Cache</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2021-02-01T00:00:00&#43;00:00" itemprop="datePublished"> Feb 1, 2021 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b>Table of Contents</b></summary>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#disclaimer">Disclaimer</a></li>
  </ul>

  <ul>
    <li><a href="#logging-cache-hits-and-misses">Logging Cache Hits And Misses</a></li>
    <li><a href="#printing-http-cache">Printing HTTP Cache</a></li>
  </ul>

  <ul>
    <li><a href="#stores-duplicate-data">Stores Duplicate Data</a></li>
    <li><a href="#cannot-observe-changes">Cannot Observe Changes</a></li>
    <li><a href="#does-not-work-with-http-mutations">Does Not Work With HTTP Mutations</a></li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <p>Caching is the practice of storing data that we requested previously so we can serve it faster in the future. This creates a better user experience by decreasing loading times. It also has long term benefits like reducing the number of network requests, to save on phone resources or potentially provide offline support. Today, we&rsquo;re going to discuss how to use the <a href="https://www.apollographql.com/docs/android/essentials/http-cache/">HTTP cache</a> for the <a href="https://github.com/apollographql/apollo-android">Apollo Android SDK</a>.</p>
<h2 id="disclaimer">Disclaimer</h2>
<p>This post is written assuming some basic knowledge of the Apollo Android library and GraphQL. If you&rsquo;re unfamiliar with the topic, you can start with the <a href="https://www.apollographql.com/docs/android/essentials/get-started-kotlin/">official documentation</a>, or with this presentation from <a href="https://www.youtube.com/watch?v=np3JSkjisCk">Android Makers 2020</a>.</p>
<p>You can find a sample project with all of the code from this blog post on <a href="https://github.com/AdamMc331/ApolloCaching">GitHub</a>.</p>
<h1 id="http-cache">HTTP Cache</h1>
<p>From the <a href="https://www.apollographql.com/docs/android/essentials/http-cache/">documentation</a>, the HTTP cache is easier to set up but it does have some limitations. We&rsquo;ll start by understanding how it works, how to set it up ourselves, and what limitations we might run into.</p>
<h1 id="how-it-works">How It Works</h1>
<p>The HTTP cache stores data in a file directory on the device. With every GraphQL request we make, a unique key is created for that request. Then, upon response from our API, we store that response in a file with that unique key.</p>
<p>The next time our application makes that same request, Apollo will check our cache directory to see if a file with that key exists, and return the response that was stored, rather than requesting from the API again.</p>
<h1 id="implementing-http-cache">Implementing HTTP Cache</h1>
<p>To implement the HTTP cache, we need to do the following:</p>
<ol>
<li>Create our cache directory.</li>
<li>Set a max size of the directory. Once this max size is reached, Apollo will remove the oldest entries.</li>
<li>Apply this cache in our Apollo Client builder.</li>
</ol>
<p>In code, that would look like this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">val</span> <span class="py">file</span> <span class="p">=</span> <span class="n">File</span><span class="p">(</span><span class="n">applicationContext</span><span class="p">.</span><span class="n">cacheDir</span><span class="p">,</span> <span class="s2">&#34;apolloCache&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// 1 MB = 1 x 1024 x 1024
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">val</span> <span class="py">numMegabytes</span> <span class="p">=</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="py">sizeInMegabytes</span> <span class="p">=</span> <span class="n">BYTES_PER_KILOBYTE</span> <span class="p">*</span> <span class="n">KILOBYTES_PER_MEGABYTE</span> <span class="p">*</span> <span class="n">numMegabytes</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="py">cacheStore</span> <span class="p">=</span> <span class="n">DiskLruHttpCacheStore</span><span class="p">(</span><span class="k">file</span><span class="p">,</span> <span class="n">sizeInMegabytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="py">httpCache</span> <span class="p">=</span> <span class="n">ApolloHttpCache</span><span class="p">(</span><span class="n">cacheStore</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="py">apolloClient</span> <span class="p">=</span> <span class="nc">ApolloClient</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">httpCache</span><span class="p">(</span><span class="n">httpCache</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">build</span><span class="p">()</span>
</span></span></code></pre></div><h1 id="querying-from-the-cache">Querying From The Cache</h1>
<p>Creating a cache and applying it to our ApolloClient instance isn&rsquo;t enough. We also need to tell the application when and how to use the cache, which we do through one of the <a href="https://www.apollographql.com/docs/android/essentials/http-cache/#raw-http-response-cache">HttpCachePolicy</a> configurations. We have two options for setting a cache policy.</p>
<p>We can choose to set a default for our ApolloClient:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">val</span> <span class="py">apolloClient</span> <span class="p">=</span> <span class="nc">ApolloClient</span><span class="p">.</span><span class="n">builder</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">httpCache</span><span class="p">(</span><span class="n">httpCache</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">defaultHttpCachePolicy</span><span class="p">(</span><span class="nc">HttpCachePolicy</span><span class="p">.</span><span class="n">CACHE_FIRST</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">build</span><span class="p">()</span>
</span></span></code></pre></div><p>Or we can choose to set it per query:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">val</span> <span class="py">response</span> <span class="p">=</span> <span class="n">apolloClient</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">toBuilder</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">httpCachePolicy</span><span class="p">(</span><span class="nc">HttpCachePolicy</span><span class="p">.</span><span class="n">CACHE_FIRST</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">build</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">await</span><span class="p">()</span>
</span></span></code></pre></div><h1 id="invalidating-http-cache">Invalidating HTTP Cache</h1>
<p>For the HTTP Cache, we have a few different ways we can expire or invalidate data.</p>
<ol>
<li>We can set a time limit on the data, after which it is considered expired and not to be used.</li>
<li>We can expire a cache entry immediately after reading it.</li>
<li>We can clear the entire cache.</li>
</ol>
<p>Here is the respective code for each option:</p>
<pre tabindex="0"><code>val oneHourPolicy = HttpCachePolicy.CACHE_FIRST.expireAfter(1, TimeUnit.HOURS)

val removeAfterRead = HttpCachePolicy.CACHE_FIRST.expireAfterRead()

// Clear manually
apolloClient.clearHttpCache()
</code></pre><h1 id="debugging-http-cache">Debugging HTTP Cache</h1>
<p>Once we&rsquo;ve implemented an HTTP cache, it&rsquo;s important to understand if it&rsquo;s working the way we expect it to. There&rsquo;s a couple options for doing this.</p>
<h2 id="logging-cache-hits-and-misses">Logging Cache Hits And Misses</h2>
<p>When we create our HTTP Cache, we have a parameter on <code>ApolloHttpCache</code> to pass an instance of a <code>Logger</code>. We can use <code>ApolloAndroidLogger</code> to get detailed information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">val</span> <span class="py">file</span> <span class="p">=</span> <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">val</span> <span class="py">sizeInMegabytes</span> <span class="p">=</span> <span class="o">..</span> <span class="p">,,,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="py">cacheStore</span> <span class="p">=</span> <span class="n">DiskLruHttpCacheStore</span><span class="p">(</span><span class="k">file</span><span class="p">,</span> <span class="n">sizeInMegabytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="py">httpCache</span> <span class="p">=</span> <span class="n">ApolloHttpCache</span><span class="p">(</span><span class="n">cacheStore</span><span class="p">,</span> <span class="n">ApolloAndroidLogger</span><span class="p">())</span>
</span></span></code></pre></div><p>This class is from the <a href="https://github.com/apollographql/apollo-android/tree/main/apollo-android-support">Apollo-Android-Support</a> artifact, and logs Apollo messages into the logcat for us. If we apply this logger, we can see as we run our app how the cache is affecting query results:</p>
<pre tabindex="0"><code>D/ApolloAndroidLogger: Cache first for request: ...
D/ApolloAndroidLogger: Cache HIT for request: ...

D/ApolloAndroidLogger: Cache first for request: ...
D/ApolloAndroidLogger: Cache MISS for request: ...

D/ApolloAndroidLogger: Cache first for request: ...
D/ApolloAndroidLogger: Cache HIT for request: ...
</code></pre><h2 id="printing-http-cache">Printing HTTP Cache</h2>
<p>This method is a little more complex, as it requires having to understand how information is stored inside the HTTP Cache. I do not recommend using this tool often, but it can help provider some insights. Since the HTTP cache is just stored inside of a file directory, we have the ability to loop through that directory and print whatever is inside:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">private</span> <span class="k">fun</span> <span class="nf">printHttpCache</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">val</span> <span class="py">cacheDirectory</span> <span class="p">=</span> <span class="n">File</span><span class="p">(</span><span class="n">applicationContext</span><span class="p">.</span><span class="n">cacheDir</span><span class="p">,</span> <span class="s2">&#34;apolloCache&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cacheDirectory</span><span class="p">.</span><span class="n">listFiles</span><span class="p">()</span><span class="o">?.</span><span class="n">forEach</span> <span class="p">{</span> <span class="k">file</span> <span class="o">-&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nc">Log</span><span class="p">.</span><span class="n">d</span><span class="p">(</span><span class="s2">&#34;ApolloHttpCache&#34;</span><span class="p">,</span> <span class="s2">&#34;HttpCacheFile: </span><span class="si">${file.name}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nc">Log</span><span class="p">.</span><span class="n">d</span><span class="p">(</span><span class="s2">&#34;ApolloHttpCache&#34;</span><span class="p">,</span> <span class="s2">&#34;HttpCacheFile: </span><span class="si">${file.readText()}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nc">Log</span><span class="p">.</span><span class="n">d</span><span class="p">(</span><span class="s2">&#34;ApolloHttpCache&#34;</span><span class="p">,</span> <span class="s2">&#34;-----&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Using this, we can get a quick overview of what is inside our cache. Some files are quite large, but we can highlight one file where we can see that a CountryDetailQuery response was stored in:</p>
<pre tabindex="0"><code>D/ApolloHttpCache: HttpCacheFile: 61b4ca292f9e869f711db7612be3e67e.1
D/ApolloHttpCache: HttpCacheFile: {&#34;data&#34;:{&#34;country&#34;:{&#34;__typename&#34;:&#34;Country&#34;,&#34;code&#34;:&#34;AU&#34;,&#34;name&#34;:&#34;Australia&#34;,&#34;continent&#34;:{&#34;__typename&#34;:&#34;Continent&#34;,&#34;code&#34;:&#34;OC&#34;,&#34;name&#34;:&#34;Oceania&#34;},&#34;capital&#34;:&#34;Canberra&#34;,&#34;emoji&#34;:&#34;ðŸ‡¦ðŸ‡º&#34;}}}
D/ApolloHttpCache: -----
</code></pre><p>The file name, <code>61b4ca292f9e869f711db7612be3e67e.1</code>, is a reference to the cache key that Apollo generates for that request. The next time I try to search for Australia, Apollo looks to see if a file with that key exists already.</p>
<p>Using the file directory itself is complicated, but it can provide some visual clues as to what is or is not inside our cache, if necessary.</p>
<h1 id="limitations">Limitations</h1>
<p>Way back in the beginning of this post, we discussed that the HTTP cache was quick to set up but had some limitations. Here is a list of some limitations that might impact your app.</p>
<h2 id="stores-duplicate-data">Stores Duplicate Data</h2>
<p>If multiple operations request similar information, it is stored twice. For example, our CountryListQuery and CountryDetailQuery each request the same information. This is stored in two files - one for the list response, and one for the detail response. We have no way to link these two files together to avoid requesting information a second time.</p>
<h2 id="cannot-observe-changes">Cannot Observe Changes</h2>
<p>As a result of using the file system, there is no easy way for us to observe changes to the HTTP cache. If we delete or modify an existing entry, any screens that requested data are now out of date and need to make new requests to be in sync again.</p>
<h2 id="does-not-work-with-http-mutations">Does Not Work With HTTP Mutations</h2>
<p>The HTTP cache does not support caching of GraphQL mutations, only query requests.</p>
<h1 id="recap">Recap</h1>
<p>The Apollo HTTP cache is a great built in tool from Apollo that helps us store data to create better user experiences. Leveraging this cache decreases loading times and cuts down on network requests. It&rsquo;s quick to set up, but does have some potential limitations. If those limitations are fine in your projects, give it a shot! If you need support for observing changes and relating data in the cache, check out our next post on the <a href="https://www.apollographql.com/docs/android/essentials/normalized-cache/">normalized cache</a>.</p>
            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://twitch.tv/adammc" target="_blank" rel="noopener noreferrer me"
    title="Twitch">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"></path>
</svg>
</a>
<a href="https://bsky.app/profile/adammc.bsky.social" target="_blank" rel="noopener noreferrer me"
    title="Bluesky">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
    d="M11.999,10.236c0.321,-0.524 0.916,-1.507 1.405,-2.376c0.755,-1.344 1.692,-2.852 2.869,-4.028c1.283,-1.281 2.845,-2.171 4.739,-2.171c1.144,-0 1.864,0.585 2.299,1.497c0.486,1.017 0.545,2.551 0.51,3.883c-0.051,1.945 -0.232,3.337 -0.505,4.275c-0.229,0.786 -0.543,1.303 -0.878,1.615c-0.892,0.833 -1.8,1.263 -2.634,1.484c0.029,0.018 0.056,0.036 0.084,0.055c0.528,0.367 0.823,0.79 1.081,1.107c0.648,0.794 0.644,1.795 0.23,2.784c-0.481,1.151 -1.533,2.279 -2.12,2.773c-1.389,1.171 -2.506,1.362 -3.383,1.133c-0.88,-0.23 -1.59,-0.932 -2.156,-1.826c-0.45,-0.71 -0.817,-1.537 -1.176,-2.186c-0.115,-0.208 -0.302,-0.455 -0.406,-0.587c-0.02,0.019 -0.04,0.04 -0.056,0.058c-0.121,0.145 -0.234,0.328 -0.349,0.531c-0.363,0.644 -0.721,1.463 -1.157,2.166c-0.555,0.895 -1.252,1.597 -2.12,1.825c-0.863,0.227 -1.97,0.037 -3.363,-1.136c-0.586,-0.494 -1.638,-1.622 -2.119,-2.773c-0.414,-0.989 -0.418,-1.99 0.229,-2.784c0.258,-0.317 0.554,-0.74 1.082,-1.106c0.027,-0.019 0.055,-0.038 0.084,-0.056c-0.834,-0.221 -1.742,-0.651 -2.634,-1.484c-0.335,-0.312 -0.649,-0.829 -0.878,-1.615c-0.273,-0.938 -0.454,-2.33 -0.505,-4.275c-0.036,-1.332 0.024,-2.866 0.509,-3.883c0.435,-0.912 1.156,-1.497 2.3,-1.497c2.32,0 4.109,1.203 5.494,2.808c1.272,1.474 2.195,3.283 2.9,4.643c0.231,0.447 0.436,0.84 0.624,1.146Zm-0.01,5.653l0.296,0.031l0.271,0.086c0.208,0.088 0.413,0.229 0.607,0.428c0.455,0.467 0.882,1.369 1.36,2.284c0.249,0.477 0.518,0.958 0.841,1.339c0.231,0.274 0.483,0.502 0.805,0.569c0.488,0.103 1.052,-0.157 1.811,-0.797c0.452,-0.38 1.274,-1.239 1.645,-2.126c0.155,-0.371 0.265,-0.75 0.022,-1.048c-0.179,-0.22 -0.366,-0.529 -0.732,-0.783c-0.536,-0.372 -1.356,-0.51 -1.905,-0.654c-0.405,-0.106 -0.715,-0.234 -0.88,-0.355l-0.284,-0.303l-0.135,-0.367l-0.008,-0.211l0.035,-0.196l0.078,-0.195l0.142,-0.209l0.198,-0.181l0.296,-0.154c0.151,-0.055 0.348,-0.092 0.587,-0.104c0.815,-0.042 2.571,0.294 4.235,-1.259c0.171,-0.159 0.288,-0.445 0.404,-0.845c0.246,-0.843 0.391,-2.096 0.438,-3.843c0.024,-0.91 0.026,-1.938 -0.208,-2.738c-0.142,-0.486 -0.367,-0.891 -0.896,-0.891c-1.675,0 -2.974,0.983 -4.031,2.21c-1.179,1.369 -2.058,3.057 -2.752,4.321c-0.483,0.88 -0.902,1.573 -1.25,1.916c-0.088,0.086 -0.174,0.157 -0.257,0.214l-0.221,0.125l-0.228,0.078l-0.267,0.031l-0.274,-0.034l-0.231,-0.083l-0.219,-0.132c-0.081,-0.058 -0.164,-0.131 -0.248,-0.22c-0.327,-0.343 -0.718,-1.037 -1.174,-1.917c-0.654,-1.262 -1.497,-2.948 -2.676,-4.314c-1.067,-1.236 -2.417,-2.217 -4.203,-2.217c-0.53,0 -0.754,0.405 -0.896,0.891c-0.234,0.8 -0.232,1.828 -0.208,2.738c0.046,1.747 0.192,3 0.438,3.843c0.116,0.4 0.233,0.686 0.403,0.845c1.665,1.553 3.421,1.217 4.235,1.259c0.24,0.012 0.437,0.049 0.588,0.104l0.295,0.154l0.199,0.181l0.142,0.209l0.078,0.195l0.035,0.196l-0.009,0.211l-0.135,0.368l-0.283,0.303c-0.165,0.12 -0.476,0.248 -0.88,0.355c-0.549,0.144 -1.369,0.281 -1.905,0.653c-0.366,0.254 -0.554,0.564 -0.732,0.783c-0.243,0.298 -0.133,0.677 0.022,1.048c0.371,0.887 1.193,1.746 1.645,2.127c0.757,0.637 1.311,0.9 1.789,0.8c0.311,-0.066 0.55,-0.29 0.772,-0.557c0.315,-0.381 0.577,-0.86 0.822,-1.337c0.394,-0.763 0.752,-1.521 1.138,-2.01c0.431,-0.544 0.929,-0.815 1.455,-0.815Z" style="fill-rule:nonzero;"/>
</svg>
</a>
<a href="https://www.youtube.com/@AdamMc331" target="_blank" rel="noopener noreferrer me"
    title="Youtube">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z">
    </path>
    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
</svg>
</a>
<a href="https://github.com/AdamMc331" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        Â© 2025 Adam McNeilly.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
