<!DOCTYPE html>
<html lang="en-us"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">Unit Testing Custom Lint Checks | Android Essence</title>
<meta property="og:title" content="Unit Testing Custom Lint Checks | Android Essence" />
<meta name="twitter:title" content="Unit Testing Custom Lint Checks | Android Essence" />
<meta itemprop="name" content="Unit Testing Custom Lint Checks | Android Essence" />
<meta name="application-name" content="Unit Testing Custom Lint Checks | Android Essence" />
<meta property="og:site_name" content="Android Essence" />

<meta name="description" content="Simplified Android Development">
<meta itemprop="description" content="Simplified Android Development" />
<meta property="og:description" content="Simplified Android Development" />
<meta name="twitter:description" content="Simplified Android Development" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />

  <link rel="alternate" hreflang="en-us" href="http://localhost:1313/unit-testing-custom-lint-checks/" title="" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2021-03-01T00:00:00Z />
    <meta property="article:published_time" content=2021-03-01T00:00:00Z />
    <meta property="og:url" content="http://localhost:1313/unit-testing-custom-lint-checks/" />

    
    <meta property="og:article:author" content="Adam McNeilly" />
    <meta property="article:author" content="Adam McNeilly" />
    <meta name="author" content="Adam McNeilly" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "Unit Testing Custom Lint Checks",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2021-03-01",
        "description": "",
        "wordCount":  1112 ,
        "mainEntityOfPage": "True",
        "dateModified": "2021-03-01",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Android Essence"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.148.2">

    
    <meta property="og:url" content="http://localhost:1313/unit-testing-custom-lint-checks/">
  <meta property="og:site_name" content="Android Essence">
  <meta property="og:title" content="Unit Testing Custom Lint Checks">
  <meta property="og:description" content="In our previous post we looked at writing a custom lint check to enforce usages of a custom view instead of an Android framework implementation.
In this post, we’ll go over how to unit test such a scenario, and take the opportunity to look at some additional options of unit testing with lint as well.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-03-01T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-03-01T00:00:00+00:00">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Unit Testing Custom Lint Checks">
  <meta name="twitter:description" content="In our previous post we looked at writing a custom lint check to enforce usages of a custom view instead of an Android framework implementation.
In this post, we’ll go over how to unit test such a scenario, and take the opportunity to look at some additional options of unit testing with lint as well.">


    

    <link rel="canonical" href="http://localhost:1313/unit-testing-custom-lint-checks/">
    <link href="/style.min.2d921c18cf1ec555ffc03d59a8adc211c402c68c930c27d6a0c306ab175a8d09.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/about/">
                        About
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">Unit Testing Custom Lint Checks</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2021-03-01T00:00:00&#43;00:00" itemprop="datePublished"> Mar 1, 2021 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p>In our <a href="/enforce-custom-views-with-lint/">previous post</a> we looked at writing a custom lint check to enforce usages of a custom view instead of an Android framework implementation.</p>
<p>In this post, we&rsquo;ll go over how to unit test such a scenario, and take the opportunity to look at some additional options of unit testing with lint as well.</p>
<h2 id="dependencies">Dependencies</h2>
<p>Just to get it out of the way, you will need to add the <code>lint-tests</code> dependency on your lint module in the project:</p>
<pre tabindex="0"><code>dependencies {
    implementation &#34;org.jetbrains.kotlin:kotlin-stdlib:$kotlin_version&#34;

    compileOnly &#34;org.jetbrains.kotlin:kotlin-stdlib-jdk7:$kotlin_version&#34;
    compileOnly &#34;com.android.tools.lint:lint-api:27.1.2&#34;
    compileOnly &#34;com.android.tools.lint:lint-checks:27.1.2&#34;

    // ADD THESE!
    testImplementation &#34;com.android.tools.lint:lint-tests:27.1.2&#34;
    testImplementation &#34;junit:junit:4.13.2&#34;
}
</code></pre><h1 id="lintdetectortest">LintDetectorTest</h1>
<p>When writing a test for our lint check, we want the test class to extend <code>LintDetectorTest</code>. This class provides some utilities for validating a <code>Detector</code> - which we wrote in the previous post.</p>
<p><code>LintDetectorTest</code> is an abstract class that requires us to define the <code>Detector</code> that we&rsquo;re testing, and which <code>Issues</code> that are under test as well.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="nd">@RunWith</span><span class="p">(</span><span class="n">JUnit4</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">UnusedStudyGuideViewDetectorTest</span> <span class="p">:</span> <span class="n">LintDetectorTest</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getDetector</span><span class="p">():</span> <span class="n">Detector</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">UnusedStudyGuideViewDetector</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">override</span> <span class="k">fun</span> <span class="nf">getIssues</span><span class="p">():</span> <span class="n">MutableList</span><span class="p">&lt;</span><span class="n">Issue</span><span class="p">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">mutableListOf</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="nc">UnusedStudyGuideViewDetector</span><span class="p">.</span><span class="n">ISSUE_UNUSED_STUDY_GUIDE_VIEW</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h1 id="test-cases">Test Cases</h1>
<p>Before looking at code, let&rsquo;s review all steps that are required to writing a lint test. In our project, each one is going to follow the same flow:</p>
<ol>
<li>Create a <code>TestLintTask</code>.</li>
<li>Provide all of the <code>TestFiles</code> that we want to test. This is where we mock up the XML, or potentially Java/Kotlin files that we want to test.</li>
<li>Provide any additional configuration of the task, if necessary.</li>
<li>Run the task.</li>
<li>Perform any assertions on the <code>TestLintResult</code>.</li>
</ol>
<h1 id="success-test">Success Test</h1>
<p>Let&rsquo;s write a test that we expect to pass. To do this, we&rsquo;ll provide some mock XML that uses the <code>StudyGuideBottomNavigationView</code>. We&rsquo;ll run lint, and ensure there were no errors. Let&rsquo;s break down each step.</p>
<h2 id="start-testlinttask">Start TestLintTask</h2>
<p>To create an instance of <code>TestLintTask</code>, we can call the <code>lint()</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="k">fun</span> <span class="nf">passesWithStudyGuideBottomNavigationView</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">var</span> <span class="py">task</span> <span class="p">=</span> <span class="n">lint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>Spoiler: You don&rsquo;t need to keep a reference to the task, we&rsquo;ll remove it in the last code sample, but it helps to understand as we split steps.</p>
<h2 id="provide-testfile">Provide TestFile</h2>
<p>Next we need to create the file that we&rsquo;re going to run lint against. We do that by calling the appropriate method, <code>xml(fileName, fileContents)</code>. There&rsquo;s a kotlin and a java equivalent as well. Here is what that looks like for our test:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="k">fun</span> <span class="nf">passesWithStudyGuideBottomNavigationView</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">val</span> <span class="py">layoutFile</span> <span class="p">=</span> <span class="n">xml</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;res/layout/layout.xml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;com.adammcneilly.androidstudyguide.ui.StudyGuideBottomNavigationView 
</span></span></span><span class="line"><span class="cl"><span class="s">    xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_width=&#34;wrap_content&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_height=&#34;wrap_content&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="p">=</span> <span class="n">task</span><span class="p">.</span><span class="n">files</span><span class="p">(</span><span class="n">layoutFile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><h2 id="provide-additional-configurations">Provide Additional Configurations</h2>
<p>When running these tests for the first time, you may experience an <code>AssertionError</code>:</p>
<pre tabindex="0"><code>java.lang.AssertionError: This test requires an Android SDK: No SDK configured. 
If this test does not really need an SDK, set TestLintTask#allowMissingSdk(). Otherwise, make sure an SDK is available either by specifically pointing to one via TestLintTask#sdkHome(File), or configure $ANDROID_HOME in the environment
</code></pre><p>If you don&rsquo;t need the SDK installed, (which we don&rsquo;t in our test), we can just implement the test method the error described:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="k">fun</span> <span class="nf">passesWithStudyGuideBottomNavigationView</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span> <span class="p">=</span> <span class="n">task</span><span class="p">.</span><span class="n">allowMissingSdk</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></div><p>There are some other configurations you can supply here, such as requiring the compileSdkVersion to be installed, whether or not to allow compilation errors, setting a baseline file, and more.</p>
<h2 id="run-and-perform-assertions">Run And Perform Assertions</h2>
<p>Once you&rsquo;ve set up your task, we can run it and perform any assertions. Here, we want to ensure that no errors occured:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="k">fun</span> <span class="nf">passesWithStudyGuideBottomNavigationView</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ... 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="n">task</span><span class="p">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">expectClean</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h2 id="all-together">All Together</h2>
<p>Let&rsquo;s throw all of that code together into one block:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="k">fun</span> <span class="nf">passesWithStudyGuideBottomNavigationView</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">lint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">files</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">xml</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;res/layout/layout.xml&#34;</span><span class="p">,</span> <span class="s">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;com.adammcneilly.androidstudyguide.ui.StudyGuideBottomNavigationView 
</span></span></span><span class="line"><span class="cl"><span class="s">    xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_width=&#34;wrap_content&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_height=&#34;wrap_content&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">allowMissingSdk</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">.</span><span class="n">expectClean</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h1 id="exploring-linttestresult">Exploring LintTestResult</h1>
<p>Now that we have a formula for creating a lint test, let&rsquo;s highlight some of the helpful methods for validation inside <code>LintTestResult</code>. We&rsquo;ve already seen <code>expectClean()</code>, which is useful for verifying that there are no lint errors. What do we do if we are testing code with violations, though?</p>
<h2 id="validating-warning-counts">Validating Warning Counts</h2>
<p>A quick, high level way to validate a lint result is to check the number of warnings. While it&rsquo;s not as thorough as checking that a specific warning was emitted, knowing that the count emitted was the count expected can provide confidence.</p>
<p>Every lint warning has a <code>Severity</code> associated with it. Most common are <code>Severity.WARNING</code> and <code>Severity.ERROR</code>, but we also have <code>INFORMATIONAL</code> and <code>IGNORE</code>.</p>
<p>For warnings and errors, we have utility methods already:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="n">lint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">expectWarningCount</span><span class="p">(</span><span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">expectErrorCount</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span></span></code></pre></div><p>If you want to check other <code>Severity</code> levels, you can pass them into the <code>expectCount</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="n">lint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">expectCount</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="m">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nc">Severity</span><span class="p">.</span><span class="n">INFORMATIONAL</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><h2 id="validating-lint-output">Validating Lint Output</h2>
<p>If you&rsquo;re aware of the actual text that you expect to be output from a lint test, you can do a match against a string:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="n">lint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="k">expect</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">res/layout/layout.xml:2: Error: This view must be replaced by a custom Study Guide implementation. [UnusedStudyGuideView]
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;com.google.android.material.bottomnavigation.BottomNavigationView 
</span></span></span><span class="line"><span class="cl"><span class="s">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</span></span></span><span class="line"><span class="cl"><span class="s">1 errors, 0 warnings
</span></span></span><span class="line"><span class="cl"><span class="s">    &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><p>If you want to get really fancy with this approach, there is a <code>.expectMatches()</code> method that allows you to pass in some RegEx, but I am not skilled enough to write about that one.</p>
<p>Even more robust, the lint-tests artifacts provides a <code>TestResultChecker</code> interface that you can implement yourself, and use that to valid your lint outputs, if you need special validations on the output.</p>
<h2 id="validating-fixes">Validating Fixes</h2>
<p>In addition to verifying that your lint check outputs correctly, you may want to verify that any quick fixes you provide work as well. There are two quick approaches to validating that.</p>
<p>First, we can validate the diff result of a lint fix using the <code>.expectFixDiffs()</code> method:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="n">lint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">expectFixDiffs</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">Fix for res/layout/layout.xml line 2: Replace with com.adammcneilly.androidstudyguide.ui.StudyGuideBottomNavigationView:
</span></span></span><span class="line"><span class="cl"><span class="s">@@ -2 +2
</span></span></span><span class="line"><span class="cl"><span class="s">- &lt;com.google.android.material.bottomnavigation.BottomNavigationView
</span></span></span><span class="line"><span class="cl"><span class="s">+ &lt;com.adammcneilly.androidstudyguide.ui.StudyGuideBottomNavigationView
</span></span></span><span class="line"><span class="cl"><span class="s">        &#34;&#34;&#34;</span><span class="p">.</span><span class="n">trimIndent</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><p>Another approach is to supply a <code>TestFile</code> with what you expect your code to look like after a fix:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="line"><span class="cl"><span class="k">val</span> <span class="py">initialFile</span> <span class="p">=</span> <span class="n">xml</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;res/layout/layout.xml&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;com.google.android.material.bottomnavigation.BottomNavigationView 
</span></span></span><span class="line"><span class="cl"><span class="s">    xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_width=&#34;wrap_content&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_height=&#34;wrap_content&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">val</span> <span class="py">fixedFile</span> <span class="p">=</span> <span class="n">xml</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;res/layout/layout.xml&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">    <span class="s">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;com.adammcneilly.androidstudyguide.ui.StudyGuideBottomNavigationView 
</span></span></span><span class="line"><span class="cl"><span class="s">    xmlns:android=&#34;http://schemas.android.com/apk/res/android&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_width=&#34;wrap_content&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">    android:layout_height=&#34;wrap_content&#34; /&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">lint</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">files</span><span class="p">(</span><span class="n">initialFile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="n">run</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// If you only have one quick fix, we can pass null. Otherwise, pass the name
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// of this fix you want to validate. 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">.</span><span class="n">checkFix</span><span class="p">(</span><span class="n">fix</span> <span class="p">=</span> <span class="k">null</span><span class="p">,</span> <span class="n">after</span> <span class="p">=</span> <span class="n">fixedFile</span><span class="p">)</span>
</span></span></code></pre></div><h1 id="recap">Recap</h1>
<p>There&rsquo;s even more we can do with the lint-tests dependency, but this should be more than enough to get started. We looked at how to formulate a custom lint test, and the different types of validations we can run against those checks. This should be a great foundation to determine which validations are best for your application. If you&rsquo;d like to see more sample unit tests, you can find them in <a href="https://github.com/AdamMc331/AndroidStudyGuide/blob/development/lint-checks/src/test/java/com/adammcneilly/studyguide/lint/UnusedStudyGuideViewDetectorTest.kt">this sample project</a>.</p>
            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://twitch.tv/adammc" target="_blank" rel="noopener noreferrer me"
    title="Twitch">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"></path>
</svg>
</a>
<a href="https://bsky.app/profile/adammc.bsky.social" target="_blank" rel="noopener noreferrer me"
    title="Bluesky">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
    d="M11.999,10.236c0.321,-0.524 0.916,-1.507 1.405,-2.376c0.755,-1.344 1.692,-2.852 2.869,-4.028c1.283,-1.281 2.845,-2.171 4.739,-2.171c1.144,-0 1.864,0.585 2.299,1.497c0.486,1.017 0.545,2.551 0.51,3.883c-0.051,1.945 -0.232,3.337 -0.505,4.275c-0.229,0.786 -0.543,1.303 -0.878,1.615c-0.892,0.833 -1.8,1.263 -2.634,1.484c0.029,0.018 0.056,0.036 0.084,0.055c0.528,0.367 0.823,0.79 1.081,1.107c0.648,0.794 0.644,1.795 0.23,2.784c-0.481,1.151 -1.533,2.279 -2.12,2.773c-1.389,1.171 -2.506,1.362 -3.383,1.133c-0.88,-0.23 -1.59,-0.932 -2.156,-1.826c-0.45,-0.71 -0.817,-1.537 -1.176,-2.186c-0.115,-0.208 -0.302,-0.455 -0.406,-0.587c-0.02,0.019 -0.04,0.04 -0.056,0.058c-0.121,0.145 -0.234,0.328 -0.349,0.531c-0.363,0.644 -0.721,1.463 -1.157,2.166c-0.555,0.895 -1.252,1.597 -2.12,1.825c-0.863,0.227 -1.97,0.037 -3.363,-1.136c-0.586,-0.494 -1.638,-1.622 -2.119,-2.773c-0.414,-0.989 -0.418,-1.99 0.229,-2.784c0.258,-0.317 0.554,-0.74 1.082,-1.106c0.027,-0.019 0.055,-0.038 0.084,-0.056c-0.834,-0.221 -1.742,-0.651 -2.634,-1.484c-0.335,-0.312 -0.649,-0.829 -0.878,-1.615c-0.273,-0.938 -0.454,-2.33 -0.505,-4.275c-0.036,-1.332 0.024,-2.866 0.509,-3.883c0.435,-0.912 1.156,-1.497 2.3,-1.497c2.32,0 4.109,1.203 5.494,2.808c1.272,1.474 2.195,3.283 2.9,4.643c0.231,0.447 0.436,0.84 0.624,1.146Zm-0.01,5.653l0.296,0.031l0.271,0.086c0.208,0.088 0.413,0.229 0.607,0.428c0.455,0.467 0.882,1.369 1.36,2.284c0.249,0.477 0.518,0.958 0.841,1.339c0.231,0.274 0.483,0.502 0.805,0.569c0.488,0.103 1.052,-0.157 1.811,-0.797c0.452,-0.38 1.274,-1.239 1.645,-2.126c0.155,-0.371 0.265,-0.75 0.022,-1.048c-0.179,-0.22 -0.366,-0.529 -0.732,-0.783c-0.536,-0.372 -1.356,-0.51 -1.905,-0.654c-0.405,-0.106 -0.715,-0.234 -0.88,-0.355l-0.284,-0.303l-0.135,-0.367l-0.008,-0.211l0.035,-0.196l0.078,-0.195l0.142,-0.209l0.198,-0.181l0.296,-0.154c0.151,-0.055 0.348,-0.092 0.587,-0.104c0.815,-0.042 2.571,0.294 4.235,-1.259c0.171,-0.159 0.288,-0.445 0.404,-0.845c0.246,-0.843 0.391,-2.096 0.438,-3.843c0.024,-0.91 0.026,-1.938 -0.208,-2.738c-0.142,-0.486 -0.367,-0.891 -0.896,-0.891c-1.675,0 -2.974,0.983 -4.031,2.21c-1.179,1.369 -2.058,3.057 -2.752,4.321c-0.483,0.88 -0.902,1.573 -1.25,1.916c-0.088,0.086 -0.174,0.157 -0.257,0.214l-0.221,0.125l-0.228,0.078l-0.267,0.031l-0.274,-0.034l-0.231,-0.083l-0.219,-0.132c-0.081,-0.058 -0.164,-0.131 -0.248,-0.22c-0.327,-0.343 -0.718,-1.037 -1.174,-1.917c-0.654,-1.262 -1.497,-2.948 -2.676,-4.314c-1.067,-1.236 -2.417,-2.217 -4.203,-2.217c-0.53,0 -0.754,0.405 -0.896,0.891c-0.234,0.8 -0.232,1.828 -0.208,2.738c0.046,1.747 0.192,3 0.438,3.843c0.116,0.4 0.233,0.686 0.403,0.845c1.665,1.553 3.421,1.217 4.235,1.259c0.24,0.012 0.437,0.049 0.588,0.104l0.295,0.154l0.199,0.181l0.142,0.209l0.078,0.195l0.035,0.196l-0.009,0.211l-0.135,0.368l-0.283,0.303c-0.165,0.12 -0.476,0.248 -0.88,0.355c-0.549,0.144 -1.369,0.281 -1.905,0.653c-0.366,0.254 -0.554,0.564 -0.732,0.783c-0.243,0.298 -0.133,0.677 0.022,1.048c0.371,0.887 1.193,1.746 1.645,2.127c0.757,0.637 1.311,0.9 1.789,0.8c0.311,-0.066 0.55,-0.29 0.772,-0.557c0.315,-0.381 0.577,-0.86 0.822,-1.337c0.394,-0.763 0.752,-1.521 1.138,-2.01c0.431,-0.544 0.929,-0.815 1.455,-0.815Z" style="fill-rule:nonzero;"/>
</svg>
</a>
<a href="https://www.youtube.com/@AdamMc331" target="_blank" rel="noopener noreferrer me"
    title="Youtube">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z">
    </path>
    <polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon>
</svg>
</a>
<a href="https://github.com/AdamMc331" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2025 Adam McNeilly.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
